# E-Commerce Bot

Telegram-–±–æ—Ç –¥–ª—è –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–∞ —Å –ø–æ–ª–Ω—ã–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–æ–º: –∫–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤, –∫–æ—Ä–∑–∏–Ω–∞, –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤, REST API, –ø–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ.
---

## üß∞ –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- Python 3.10+
- aiogram 3.x ‚Äî –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π Telegram Bot API
- FastAPI ‚Äî —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ REST API
- SQLAlchemy ‚Äî ORM –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ë–î
- SQLite ‚Äî –ª–µ–≥–∫–æ–≤–µ—Å–Ω–∞—è —Ñ–∞–π–ª–æ–≤–∞—è –ë–î
- Pydantic ‚Äî –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –¥–ª—è API
- Uvicorn ‚Äî ASGI —Å–µ—Ä–≤–µ—Ä
- pytest ‚Äî –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

---

## üß© –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

- üõí –ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤ —Å –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
- üõí –ö–æ—Ä–∑–∏–Ω–∞ –ø–æ–∫—É–ø–æ–∫ (–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ, –∏–∑–º–µ–Ω–µ–Ω–∏–µ, —É–¥–∞–ª–µ–Ω–∏–µ)
- üí≥ –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞ —á–µ—Ä–µ–∑ FSM (–∏–º—è, —Ç–µ–ª–µ—Ñ–æ–Ω, –∞–¥—Ä–µ—Å, –¥–æ—Å—Ç–∞–≤–∫–∞)
- üìä –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –Ω–æ–º–µ—Ä–∞ –∑–∞–∫–∞–∑–∞
- üéØ –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å:
  - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤
  - –ü—Ä–æ—Å–º–æ—Ç—Ä –∏ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–æ–≤
- üåê –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞–º–∏ 
- üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∑–∞–∫–∞–∑–æ–≤
- üß™ –ü–æ–ª–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (unit-—Ç–µ—Å—Ç—ã)

---

## üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```markdown
e_commerce_bot/
‚îÇ
‚îú‚îÄ‚îÄ .env                    
‚îú‚îÄ‚îÄ .gitignore              
‚îú‚îÄ‚îÄ bot.py                  
‚îú‚îÄ‚îÄ config.py               
‚îú‚îÄ‚îÄ main.py                 
‚îú‚îÄ‚îÄ README.md               
‚îú‚îÄ‚îÄ requirements.txt        
‚îú‚îÄ‚îÄ bot.db                  
‚îÇ
‚îú‚îÄ‚îÄ api/                    
‚îÇ   ‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ order.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ product.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ user.py
‚îÇ   ‚îî‚îÄ‚îÄ routes/
‚îÇ       ‚îî‚îÄ‚îÄ orders.py
‚îÇ
‚îú‚îÄ‚îÄ database/               
‚îÇ   ‚îú‚îÄ‚îÄ crud.py            
‚îÇ   ‚îú‚îÄ‚îÄ db_helper.py       
‚îÇ   ‚îú‚îÄ‚îÄ init_db.py         
‚îÇ   ‚îî‚îÄ‚îÄ models.py          
‚îÇ
‚îú‚îÄ‚îÄ handlers/               
‚îÇ   ‚îú‚îÄ‚îÄ admin_handlers.py
‚îÇ   ‚îú‚îÄ‚îÄ lk_handlers.py     
‚îÇ   ‚îú‚îÄ‚îÄ order_handlers.py  
‚îÇ   ‚îú‚îÄ‚îÄ purchase_handlers.py 
‚îÇ   ‚îî‚îÄ‚îÄ user_handlers.py   
‚îÇ
‚îú‚îÄ‚îÄ keyboards/              
‚îÇ   ‚îú‚îÄ‚îÄ admin_keyboards.py
‚îÇ   ‚îú‚îÄ‚îÄ inline_keyboards.py
‚îÇ   ‚îî‚îÄ‚îÄ lk_keyboards.py
‚îÇ
‚îú‚îÄ‚îÄ states/                 
‚îÇ   ‚îú‚îÄ‚îÄ admin_states.py
‚îÇ   ‚îú‚îÄ‚îÄ order_states.py
‚îÇ   ‚îî‚îÄ‚îÄ user_states.py
‚îÇ
‚îú‚îÄ‚îÄ templates/              
‚îÇ   ‚îî‚îÄ‚îÄ orders.html
‚îÇ
‚îî‚îÄ‚îÄ tests/                  
    ‚îú‚îÄ‚îÄ test_admin.py
    ‚îú‚îÄ‚îÄ test_cart.py
    ‚îî‚îÄ‚îÄ test_orders.py
```
---

## üîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞
1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
```bash
git clone https://github.com/wyths666/e_commerce_bot.git
cd e_commerce_bot
```

2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```bash
python -m venv .venv
source .venv/bin/activate  # Linux/Mac
# –∏–ª–∏
.venv\Scripts\activate     # Windows
pip install -r requirements.txt
```
3. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª .env
```bash
BOT_TOKEN="–≤–∞—à_—Ç–æ–∫–µ–Ω_–±–æ—Ç–∞"
ADMIN_IDS=123456789,234567891 # –ø–æ–ª—É—á–∏—Ç—å ID –º–æ–∂–Ω–æ –≤ @myidbot 
DATABASE_URL="sqlite:///./bot.db"
```
---

## ‚öô –ó–∞–ø—É—Å–∫
```bash
python bot.py
```
---

## üß™ –¢–µ—Å—Ç—ã
```markdown
pytest tests/ -v

-- test_add_product # –¢–µ—Å—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞
-- test_edit_product # –¢–µ—Å—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–∞   
-- test_delete_product # –¢–µ—Å—Ç —É–¥–∞–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞
-- test_change_order_status # –¢–µ—Å—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤ –∑–∞–∫–∞–∑–∞
-- test_get_all_orders # –¢–µ—Å—Ç –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –∑–∞–∫–∞–∑–æ–≤     
-- test_add_to_cart # –¢–µ—Å—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞ –≤ –∫–æ—Ä–∑–∏–Ω—É       
-- test_update_quantity # –¢–µ—Å—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –≤ –∫–æ—Ä–∑–∏–Ω–µ    
-- test_remove_from_cart # –¢–µ—Å—Ç —É–¥–∞–ª–µ–Ω–∏—è –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã  
-- test_create_order # –¢–µ—Å—Ç —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞        
-- test_order_number_unique # –¢–µ—Å—Ç –ø—Ä–∏—Å–≤–∞–∏–≤–∞–Ω–∏—è —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –Ω–æ–º–µ—Ä–∞ –∑–∞–∫–∞–∑–∞ 
-- test_get_orders_by_user # –¢–µ—Å—Ç –ø–æ–ª—É—á–µ–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è  
-- test_clear_cart_after_order # –¢–µ—Å—Ç –æ—á–∏—Å—Ç–∫–∏ –∫–æ—Ä–∑–∏–Ω—ã –ø–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞
```
---

## üõ† –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É /admin –¥–ª—è –≤—Ö–æ–¥–∞.
- –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ç–æ–≤–∞—Ä
- –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–≤–∞—Ä
 - –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ
 - –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ
 - –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ü–µ–Ω—É
 - –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ñ–æ—Ç–æ
 - –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é
 - –£–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä
- –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∑–∞–∫–∞–∑–æ–≤
 - –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞

---

## üìÑ –õ–æ–≥–∏
–õ–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —Ñ–∞–π–ª–µ logs/bot.log.
–¢–∞–º –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ –∑–∞–∫–∞–∑—ã, –æ—à–∏–±–∫–∏ –∏ –¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

## üìÇ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ —Ñ–∞–π–ª–µ bot.db (SQLite).

üóÉÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:
```markdown
–¢–∞–±–ª–∏—Ü–∞: categories ‚Äî –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤
- id # –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID (PK)
- name # –ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
‚úÖ –£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –ø–æ name 

–¢–∞–±–ª–∏—Ü–∞: products ‚Äî –¢–æ–≤–∞—Ä—ã
- id # –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID 
- name # –ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
- description # –û–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
- price # –¶–µ–Ω–∞ —Ç–æ–≤–∞—Ä–∞
- photo_url # URL —Ñ–æ—Ç–æ —Ç–æ–≤–∞—Ä–∞
- category_id # –í–Ω–µ—à–Ω–∏–π –∫–ª—é—á –Ω–∞ categories.id  
üîó –°–≤—è–∑—å: category_id ‚Üí categories.id 
‚úÖ –ò–Ω–¥–µ–∫—Å –ø–æ category_id 

–¢–∞–±–ª–∏—Ü–∞: cart_items ‚Äî –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫–æ—Ä–∑–∏–Ω—ã
- id # –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID (PK)
- user_id # ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (Telegram ID)
- product_id # –í–Ω–µ—à–Ω–∏–π –∫–ª—é—á –Ω–∞ products.id (FK)
- quantity # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–∞ –≤ –∫–æ—Ä–∑–∏–Ω–µ
üîó –°–≤—è–∑—å: product_id ‚Üí products.id
‚úÖ –ò–Ω–¥–µ–∫—Å –ø–æ user_id –∏ product_id 

–¢–∞–±–ª–∏—Ü–∞: orders ‚Äî –ó–∞–∫–∞–∑—ã
- id # –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID (PK)
- user_id # ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (Telegram ID)
- created_at # –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞
- status # –°—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞ (new, confirmed, delivered, cancelled)
- total_amount # –û–±—â–∞—è —Å—É–º–º–∞ –∑–∞–∫–∞–∑–∞ 
- customer_name # –ò–º—è –ø–æ–∫—É–ø–∞—Ç–µ–ª—è
- customer_phone # –¢–µ–ª–µ—Ñ–æ–Ω –ø–æ–∫—É–ø–∞—Ç–µ–ª—è 
- customer_address # –ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏
- delivery_method # –°–ø–æ—Å–æ–± –¥–æ—Å—Ç–∞–≤–∫–∏ (–ö—É—Ä—å–µ—Ä–æ–º, –°–∞–º–æ–≤—ã–≤–æ–∑, –°–î–≠–ö) 
- order_number # –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä,ORD-20250405-ABCD)
‚úÖ –£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –ø–æ order_number
‚úÖ –ò–Ω–¥–µ–∫—Å –ø–æ user_id –∏ status 
```
---

## üë®‚Äçüíª –ê–≤—Ç–æ—Ä

[–í–ª–∞—Å–æ–≤ –í–ª–∞–¥–∏c–ª–∞–≤] ‚Äî [GitHub](https://github.com/wyths666) | [Telegram](https://t.me/wyths666)